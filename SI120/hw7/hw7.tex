% !TEX program = xelatex

\documentclass{article}
\usepackage{amsfonts,amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage[left=1.0cm,right=1.0cm,top=1.3cm,bottom=1.3cm]{geometry}
\usepackage{enumerate}
\usepackage{fancyhdr}
\usepackage{ctex}
\usepackage{xpatch}
\usepackage{graphicx} %插入图片的宏包
\usepackage{float} %设置图片浮动位置的宏包
\usepackage{subfigure} %插入多图时用子图显示的宏包
\usepackage{listings}
\usepackage{color}
\usepackage{amssymb,mathrsfs,amsmath}
\usepackage{bbding}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
  language=Python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}


\newtheoremstyle{break}
    {\topsep}{\topsep}%
    {\itshape}{}%
    {\bfseries}{}%
    {\newline}{}%
\theoremstyle{break}
\newtheorem*{solution*}{\textbf{Solution:} }
%\newtheorem*{proof*}{\textbf{Proof:}}
\makeatletter

\AtBeginDocument{\xpatchcmd{\@thm}{\thm@headpunct{.}}{\thm@headpunct{}}{}{}}
\makeatother

\pagestyle{fancy} 
\lhead{Name}
\chead{\textbf{Discrete Mathematics:  Homework 6}}
\rhead{2020.4.23}
\renewcommand{\baselinestretch}{1.5}

\title{Discrete Mathematics:  Homework 6}
\author{Name  \quad  \quad ID: Number}
\date{2020.4.23}


\begin{document}
\maketitle
\begin{enumerate}
        
        \item Implement EEA (Extended Euclidean Algorithm).  
        Run your program on the integers $a, b$ to find two integers $s, t$ 
        such that $gcd(a, b) =as+bt$,\\
        where, \\
        \begin{center}
                a=166802238465144782585259345783335995398577113463773012652049701116\\
                538923976760437940161505072594109956581880570407120859036072201224135\\
                954200074894884057313342800619883956087790107134112871312954281798133\\
                333599770341730923355794098107424397318788891874452531269048425139903\\
                546799813099722273365750795484115744540571332619485021706549532667048\\
                623355476509766872917478493507825984645914283279478481427960669819408\\
                485961217770484110570494262217083738133966614498824146432614678060378\\
                894408425333849681806202717850100579245873661859442971553197985705770\\
                70773474129972107871623872384643401132513116574551025071336188925411;\\
                \leavevmode\\
                b=178557702998705193672420596813904244180961821553420411374887968796\\
                711074787435728640023831450214546816293772658338891265842068349027946\\
                975181714312229127911704475670408710944900520674073067986613374905921\\
                991707179698185015217674585778181924994572457805039180874497394105699\\
                111940506658975328079593197508682649032998192427519300030664417760154\\
                643363574813445490286783899096252597057696545050668574441049471926476\\
                671086057147242990292233548660429548075415889373254112490970960683335\\
                559765986989476083310635722822014720292990517875153280116286250879664\\
                49702534156436266476618723897816432054896528012909122280046552133534.\\
        \end{center}  
        \newpage
        The Code is as follows:\\
        \begin{lstlisting}
                from math import gcd

                def Exgcd(a: int, b: int):
                        '''
                                gcd(a,b)=ax+by
                        '''
                        if (not b):
                                return [1, 0]
                        x,y = Exgcd(b, a % b)
                        return [y, x - a // b * y]
        

                if __name__ == "__main__":
                        a = 16680223846514478258525934578333599539857711346...
                        b = 17855770299870519367242059681390424418096182155...
                        a = int(a)
                        b = int(b)
                        print(Exgcd(a,b))
        \end{lstlisting}
        \vspace{20mm}
        The Output:\\
        \[
        \begin{aligned}
                &s = 52693465174047597579174064083061206575761398656935114430811243560695\\
                &066306956237700638467741380344513260983625906545194154800126707869242\\
                &528199250303471171536207597896008405650134889458156325490296036336342\\
                &644796958477425288398387518178265890700656305714837368523496597321973\\
                &212197144244237647291270529201589,\\
                &t = -49224356025570205752640369113197589784192495362440084201087757193437\\
                 &212741118960024592916678950802342924534115789543242617936510771866636\\
                 &258909484003508425128530601681164598597924839372243612858504002463817\\
                 &184486904388029971268441911219848844590762141055813365169533361189741\\
                 &247565502362579257453658280613873 \\
        \end{aligned}
        \]
        \newpage
        \item Implement  the  Square-and-Multiply  algorithm.    Run  your  program  to  compute $a^e \bmod n$, \\
        where,\\
        \[
        \begin{aligned}
                &a=26430018304661698227244889550916468317489455778956328592921983469699792309163\\
                &6651939727062065940368694156919682211176067714945400989707665523652072105686111\\
                &0585264063004041254329784246243452678808185207454294611440427905378997639787543\\
                &5006094029065093695673255562607050336148424707698012085470002233698228862346738\\
                &7635991202108870240552511996874513924373573304693138757694152032780054294879893\\
                &7195800406213538498867618709275393334646678513506968259223976973961688493561224\\
                &5424974736666329142491909330198993521032748920319427468193197363789859738402941\\
                &190883470502934385251934875320122360082927644910373611459923294476\\
                \leavevmode\\                
                &e=14409405982160132058252555071975393865919464165649477935316970889691161917952\\
                &9383384024206261698498692401998173408187858576610409025211779025228656559593159\\
                &5502729633365857562567917164964823748671510787403884808014676043180816004775826\\
                &7886816563159460881275453304962088598750789947602763231536498803689415008248542\\
                &3069839905858727323030674427604859394835304992067509266236322183377936083054953\\
                &5347779793705521310372254828708923967502999845523783712266543178848696339228233\\
                &3218897305536581935858534831705616909506614608137265328584496490209976683510539\\
                &438184418619421230489065033982087166936851293061923363455338233631\\
                \leavevmode\\
                &n=64543139452648583804777033627501791038942806480746416798824757337964931888296\\
                &5394087753253738962962018330194333365917018506041929580090385188292077167850690\\
                &8477673738912708560686143515108791497878950835462108643709804848978316528866309\\
                &0667930959738070532371062440986402482696167926970371372070378265809277766155735\\
                &0773640013648437866289655346805208172279134358934890394382223195659502850096894\\
                &6488659653138113699743321196084282674797868993406360468278824654992876075514546\\
                &9051762866022916315234333425333466441336354964665001026523519003032764174124744\\
                &508998760069425321286184310908109489080474275209430911312055696378.\\
                \leavevmode\\
        \end{aligned}
        \]
        \newpage
        The Code is as follows:\\
        \begin{lstlisting}
                def pinbow(a: int, b: int, m: int):
                        a %= m
                        res = 1
                        while (b > 0):
                        '''
                                当b的当前二进制最低位为1时，即对应着二进制指数不为0时的Xi时
                                        平方模m
                        '''
                        if (b & 1): 
                                res = res * a % m
                        a = a * a % m
                        b >>= 1
                        return res
                
                
                if __name__ == "__main__":
                        a = 264300183046616982272448895509164683174894557789...
                        e = 144094059821601320582525550719753938659194641656...
                        n = 645431394526485838047770336275017910389428064807...
                        print(pinbow(a, e, n))
        \end{lstlisting}
        The Output is: \\
        \[
        \begin{aligned}
                &1948938994538604160707108181724192091954263523362311673846915505520625915922643\\
                &6938865465087133511096927509156841578783141212143489199923529097996539792654733\\
                &5052787068125208309422099919003183364358024089072490207637709226822372509095139\\
                &5199481472410255314243260591665020918693044381737199432444238061823906089977020\\
                &9698997113410596399791595727394196009053367816731883686504687107181648321094994\\
                &0976719953054190408051208140315555905870988234774714741823035881413138114720829\\
                &1328747857991048977465984265721979324595417184750317001715144073738047884018946\\
                &0378458005476484742953848813170374548455806977675820760128018344\\
        \end{aligned}
        \]
        \newpage
        \item Decrypt the ciphertextcin RSA, \\
        where,\\
        \[     
                \begin{aligned}
                        &p=92848022024833655041372304737256052921065477715975001419347548380734496823522\\
                        &5650441779312429471225345638134159924339171084815693198941679726397367886136560\\
                        &0785371947673662561254389374813653659449400548721348578567633362118169046394241\\
                        &7781763743640447405597892807333854156631166426238815716390011586838580891;\\
                        \leavevmode\\
                        &q=14960085493382551215982833152717710968911855521238517083138736580400843736791\\
                        &3613643959968668965614270559113472851544758183282789643129469226548555150464780\\
                        &2295380865904988537181020524685198767881928650922297496435467107934643052438158\\
                        &36267024770081889047200172952438000587807986096107675012284269101785114471;\\
                        \leavevmode\\
                        &e=40998521736306818227223396602297017934844970775490230507394067442991947407942\\
                        &8584156589485718325730596209165847825640345789849625975547419907263509732739897\\
                        &1990092224918103250375455707498928712201945370461644425637423044616348028546654\\
                        &8201345320125444335191585314853004623900975927763520176673866326616786815005427\\
                        &6683546905649003992838087797971215908090534886947521793984417375169824144266261\\
                        &1990406492300411900572847532884748092860563495914734527293634873292356463076178\\
                        &2948819009683739182920645278553069258988184216460576162388732542519399531449485\\
                        &50922456255743607156013509822605943382352582252129366170771186337;\\
                        \leavevmode\\
                        &c=19650041330069746599953145601677238965601628239920147634666762951565687801813\\
                        &2475911846635611682742243940951386582057040081038097733339789581002325451518224\\
                        &2123244875173658899005048988942666876614798046351776061310094809679938914368938\\
                        &2182898067907249926601510787188645051967549072611352212571461142898751490154313\\
                        &0156920752710863868498978972974709776665048198382274278895852859421500294064580\\
                        &6662061041825912562593269329369550470854629711422167160350497882132054038403027\\
                        &4931058558406068460630295717583862204341896109717245183304380824015928953542554\\
                        &30599515214166039595157639322144199213475742435020500518884278854.\\
                        \leavevmode\\                                                                                                 
                \end{aligned}
        \]
        \newpage
        The Code is as follows,\\
        \begin{lstlisting}
                from math import gcd
                import sys

                def Exgcd(a: int, b: int):
                        '''
                                gcd(a,b)=ax+by
                        '''
                        if (not b):
                                return [1, 0]
                        x, y = Exgcd(b, a % b)
                        return [y, x - a // b * y]


                def pinbow(a: int, b: int, m: int):
                        '''
                                return a^b mod m
                        '''
                        a %= m
                        res = 1
                        while (b > 0):
                                '''
                                        当b的当前二进制最低位为1时，即对应着二进制指数不为0时的Xi时
                                                平方模m
                                '''
                                if (b & 1): 
                                        res = res * a % m
                                a = a * a % m
                                b >>= 1
                        return res


                def Decrypt(c: int, e: int, p: int,q: int):
                        '''
                                c is the Ciphertext
                                N = pq
                                \psi_n = (p-1)(q-1)
                                The output = c^{e^{-1}} \bmod N
                        '''
                        N = p*q
                        Psi_n = (p - 1) * (q - 1)
                        e_inverse = Exgcd(e, Psi_n)[0] % Psi_n
                        return pinbow(c, e_inverse, N)


                if __name__ == "__main__":

                        #Enlarge maximum recursion depth 
                        sys.setrecursionlimit(10000000)  

                        p = 928480220248336550413723047372560529210654777159...
                        q = 149600854933825512159828331527177109689118555212...
                        e = 409985217363068182272233966022970179348449707754...
                        c = 196500413300697465999531456016772389656016282399...
                        
                        print(Decrypt(c, e, p, q))
        \end{lstlisting}
        The Output is:\\
        \[
               \begin{aligned}
                &6307076265101868022401168220914091002094923647543913608078494521549403802210173\\
                &4448910945057067346730937652835729768619355817268498169235936515098575406119647\\
                &1301870916266492597624094706385693202311368910711856996880432917328158348359209\\
                &5382533613111762918421362278333322916021933519728291798749842494918068962745956\\
                &0798274744525895426462461012207741072359737037262377332530853123806775315242266\\
                &1065653510484141953711145287662682541947393492574134608925233119524970709481240\\
                &1729770078951956524070871949864300367817846976007250758036392548367298788322489\\
                &841149673899984125317729640492807125318100997973696848942216291\\                
               \end{aligned} 
        \]
        \newpage
        \item Let $G= \{ x:x \in \mathbb{R}, x >1\}$.  Define $x * y=xy−x−y+ 2$ for all $x, y \in \mathbb{R}$.  Show that $(G, *)$ is an Abelian group.
        \begin{proof}
                \begin{enumerate}
                        \item 
                        \textbf{Closure}: \\
                        $x*y = xy - (x+y) + 2 \geq xy - 2\sqrt{xy}+2 = (\sqrt{xy}-1)^2+1>1$
                        \item 
                        \textbf{Associative}: \\
                        $x*(y*z)=x*(yz-y-z+2)=xyz-xy-xz+2x-x-yz+y+z-2+2=xyz-xy-xz+x-yz+y+z$\\
                        $(x*y)*z=(xy-x-y+2)*z=xyz-xz-yz+2z-xy+x+y-2-z+2=xyz-xz-yz+z-xy+x+y$
                        \item 
                        \textbf{Identity}:\\
                        $\exists 2 \in G, \forall  x \in G$, we have $2 * x = 2x - 2-x +2 = x =x * 2$
                        \item
                        \textbf{inverse}:\\
                        $\forall x \in G$, $\exists x^{-1} = \frac{x}{x-1}$, such that $x * x^{-1} = x \frac{x}{x-1} - x - \frac{x}{x-1} + 2 = 2$
                        \item 
                        \textbf{Commutative}:\\
                        $x*y = xy - x -y +2 = yx - y- x +2 = y*x$
                \end{enumerate}
        \end{proof}
        \item 
        Let $(G,·)$ be a multiplicative (Abelian) group of order $m$.  Show that $o(a)|m$ for any $a \in G$, i.e., the order of any group element must be a divisor of the group's order.
        \begin{proof}
                Let $G = \{  a_1, \dots , a_m \}$ \\
                By Eular's Theorem, we have, $a^m=1$\\
                $\forall a \in G$\\
                if $i \neq j$, $a_i \neq a_j$\\
                $aa_1\cdot aa_2 \dots aa_m = (a_1 \cdot a_2 \dots )a_m$\\
                $(a_1 \cdot a_2 \cdot a_m)a^m = a_1 \cdot a_2 \cdot a_m$\\
                $a^m = 1$\\
                By definition, $o(a)$ is the least integer such that $a^{o(a)} = 1$\\
                $o(a) \leq m$\\
                Suppose $m = no(a) + r, r \in [0, o(a) )$\\
                we have $a^m = a^{n o(a) + r} = (a^{o(a)})^n \cdot a^r = 1$\\
                Because $a^{o(a)} = 1$, we have $a^r = 1$ and $r = 0$\\
                so, $o(a) \mid m$
        \end{proof}
        \newpage
        \item Let $G=〈g〉$be a subgroup of $\mathbb{Z}^∗_p$ of order $q$, \\where,\\
        \[
        \begin{aligned}
                &p=17976931348623159077293051907890247336179769789423065727343008115773267580550\\
                &0963132708477322407536021120113879871393357658789768814416622492847430639474124\\
                &3777678934248654852763022196012460941194530829520850057688381506823424628814739\\
                &13110540827237163350510684586298239947245938479716304835356329624227998859\\
                & \\
                &q= (p−1)/2 and g= 3.\\            
        \end{aligned}
        \]
        \\Suppose that in a Diffie-Hellman key exchange protocol Alice and Bobexchanged the following information$ (q, G, g;A, B)$,\\
        where,\\  
        \[      
        \begin{aligned}
                &A=11298357516300261894758966666673542818168451784514487509690291006643472395262\\
                &3016603393212501214127399908823223492478725971266042754892798177781267512821607\\
                &4705452830594726890347313130276198642286884664382583275520454375902037906355067\\
                &28603774799021127049872571983254506993921153718739796769296097404717448108\\
                \leavevmode\\
                &B=11177276780521023949636519169151688104339498819629706201385364667457474340104\\
                &2736447328886156429629192691601526398366088012736749454626686281467579205675084\\
                &4619894945132946240660741372479130373300404872753469132533457334297677819009771\\
                &02687185378411660147190296412313303321533586102552123457499563789255321369\\
        \end{aligned}
        \]
        \vspace{20mm}
        \begin{solution*}
                we have:\\
                        $$g^a \bmod p = A $$
                        $$<g^{ab} >= <A^b >= <B^a>= Output$$ 
        \end{solution*}
        \newpage
        The Code is as follows,\\
        \begin{lstlisting}
                def pinbow(a: int, b: int, m: int):
                '''
                        return a^b mod m
                '''
                a %= m
                res = 1
                while (b > 0):
                        '''
                                当b的当前二进制最低位为1时，即对应着二进制指数不为0时的Xi时
                                        平方模m
                        '''
                        if (b & 1): 
                                res = res * a % m
                        a = a * a % m
                        b >>= 1
                return res


                p = 179769313486231590772930519078902473361797697894230...
                q = (p - 1) / 2
                g = 3
                A = 112983575163002618947589666666735428181684517845144...
                B = 111772767805210239496365191691516881043394988196297...

                for i in range(10000):
                        if (pinbow(g,i,p) == A):
                                print("a= ", i)
                                print("m= ",pinbow(B, i, p))
                                break
        \end{lstlisting}
        So, $a = 9385$\\
        The output is, 
        \[
        \begin{aligned}
                &1082811278345346238104170780205614986659639207224390394098745967277926067531952\\
                &2663099080388770903982546250524992420350200207624327420612300170620802665302905\\
                &7500457776843481258274843650075907186383731879368899673093247226552949922258154\\
                &10914105072210725045953105019352457540772995508978315699107247398350128\\                               
        \end{aligned}        
        \]
\end{enumerate}
\end{document}